(function(u,t){typeof exports=="object"&&typeof module!="undefined"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(u=typeof globalThis!="undefined"?globalThis:u||self,t(u.index={},u.Vue))})(this,function(u,t){"use strict";var ue="";const B=typeof window!="undefined";function b(e,n="px"){if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${n}`:void 0}const G=e=>{if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const n=window.getComputedStyle(e);return["auto","scroll"].includes(n.overflowY)&&e.scrollHeight>e.clientHeight},R=(e,n)=>e.scrollTop===0&&n<0?!0:e.scrollTop+e.clientHeight===e.scrollHeight&&n>0,W=(e,n)=>{const o=e.composedPath(),r=e.deltaY;for(let i=0;i<o.length;i++){const a=o[i];if(a===document||a===document.documentElement||a===n)return!0;if(G(a))return R(a,r)}return!0},A=()=>{const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll";const n=document.createElement("div");e.appendChild(n),document.body.appendChild(e);const o=e.offsetWidth-n.offsetWidth;return document.body.removeChild(e),o},p=t.ref([]);function L(e){const n=t.getCurrentInstance();let o;return t.watch(e,i=>{i?(o=t.effectScope(),o.run(()=>{p.value.push(n),t.onScopeDispose(()=>{const a=p.value.indexOf(n);p.value.splice(a,1)})})):o==null||o.stop()},{immediate:!0}),{isTop:t.computed(()=>t.toRaw(p.value[p.value.length-1])===n)}}const k=t.ref([]),F=1e3;function P(e){const n=t.getCurrentInstance().uid,o=t.ref(0);return t.watch(e,r=>{r?(k.value.push(n),o.value=F+(k.value.indexOf(n)+1)*2):k.value=k.value.filter(i=>i!==n)},{immediate:!0}),{zIndex:o}}const j=e=>{const n=t.ref(!1),o=t.ref(!1);return e.value&&(n.value=!0,t.nextTick(()=>{o.value=!0})),t.watch(e,r=>{if(!n.value){n.value=!0,t.nextTick(()=>{o.value=r});return}o.value=r}),{activatedOnce:n,active:o}},M=({overlay:e,content:n,contentActiveClass:o,fullscreen:r,contentFullscreenClass:i})=>{if(!B)return{disableScroll:()=>{},enableScroll:()=>{}};let a=!1,l;const c=f=>{(f.target===e.value||f.target===document.body||W(f,n.value))&&f.preventDefault()},m=A()===0;return{disableScroll:()=>{a||(m||r?(l="byOverflow",document.documentElement.classList.add("overflow-y-hidden")):(l="byEvents",window.addEventListener("wheel",c,{passive:!1})),a=!0)},enableScroll:()=>{if(!!a){if(l==="byEvents")window.removeEventListener("wheel",c);else if(l==="byOverflow"){const f=document.getElementsByClassName(o),C=document.getElementsByClassName(i);(!m&&r&&C.length===1||f.length===1)&&document.documentElement.classList.remove("overflow-y-hidden")}a=!1}}}};function U(e,n,o){t.onMounted(()=>{window.addEventListener(e,n,o)}),t.onUnmounted(()=>{window.removeEventListener(e,n)})}var me="",h=(e,n)=>{const o=e.__vccOpts||e;for(const[r,i]of n)o[r]=i;return o};const S=t.defineComponent({name:"GDialogOverlay",props:{active:{type:Boolean,required:!0},zIndex:{type:Number,required:!0},background:{type:[Boolean,String],required:!0},local:{type:Boolean,required:!0}},emits:["click"],setup(e,{emit:n}){const o=t.computed(()=>({zIndex:e.zIndex-1})),r=t.ref(e.active),i=t.ref(!1);t.watch(()=>e.active,d=>{if(i.value=!d,d){r.value=!0;return}t.nextTick(()=>{r.value=!1})});const a=t.computed(()=>["g-dialog-overlay",{"g-dialog-overlay--active":!i.value,"g-dialog-overlay--local":e.local}]),l=t.computed(()=>typeof e.background=="string"?e.background:e.background?"var(--overlay-bg)":"transparent");return{activeProxy:r,styles:o,classes:a,computedBackground:l,onClick:()=>{n("click")}}}}),E=()=>{t.useCssVars(e=>({"6eaca59a":e.computedBackground}))},N=S.setup;S.setup=N?(e,n)=>(E(),N(e,n)):E;const H=S;function K(e,n,o,r,i,a){return t.openBlock(),t.createBlock(t.Transition,{name:"fade"},{default:t.withCtx(()=>[e.activeProxy?(t.openBlock(),t.createElementBlock("div",{key:0,class:t.normalizeClass(e.classes),style:t.normalizeStyle(e.styles),onClick:n[0]||(n[0]=(...l)=>e.onClick&&e.onClick(...l))},null,6)):t.createCommentVNode("",!0)]),_:1})}var Y=h(H,[["render",K]]);const X=e=>({sizeStyles:t.computed(()=>({maxWidth:e.maxWidth==="none"?void 0:b(e.maxWidth),width:e.width==="auto"?void 0:b(e.width),height:e.height==="auto"?void 0:b(e.height)}))});var fe="";const $=t.defineComponent({name:"GDialogContent",props:{background:{type:[Boolean,String],required:!0},borderRadius:{type:[Boolean,Number,String],required:!0},class:{type:String,required:!0},depressed:{type:Boolean,required:!0},fullscreen:Boolean,height:{type:[String,Number],required:!0},maxWidth:{type:[String,Number],required:!0},scrollable:{type:Boolean,required:!0},width:{type:[String,Number],required:!0}},setup(e){const{sizeStyles:n}=X(e),o=t.computed(()=>["g-dialog-content",e.class,{"g-dialog-content--scrollable":e.scrollable,"g-dialog-content--depressed":e.depressed,"g-dialog-content--fullscreen":e.fullscreen}]),r=t.computed(()=>typeof e.background=="string"?e.background:e.background?"var(--content-bg)":"transparent"),i=t.computed(()=>typeof e.borderRadius=="string"?b(e.borderRadius):e.borderRadius?"var(--content-border-radius)":"0");return{styles:n,classes:o,computedBackground:r,computedBorderRadius:i}}}),z=()=>{t.useCssVars(e=>({"889a571a":e.computedBackground,"023a843a":e.computedBorderRadius}))},D=$.setup;$.setup=D?(e,n)=>(z(),D(e,n)):z;const Z=$;function J(e,n,o,r,i,a){return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(e.classes),style:t.normalizeStyle(e.styles)},[t.renderSlot(e.$slots,"default")],6)}var Q=h(Z,[["render",J]]),ge="";const x=t.defineComponent({name:"GDialogFrame",components:{GDialogContent:Q},inheritAttrs:!1,props:{isActive:{type:Boolean,required:!0},zIndex:{type:Number,required:!0},background:{type:[Boolean,String],required:!0},borderRadius:{type:[Boolean,Number,String],required:!0},contentClass:{type:String,required:!0},depressed:{type:Boolean,required:!0},fullscreen:{type:Boolean,required:!0},height:{type:[String,Number],required:!0},local:{type:Boolean,required:!0},maxWidth:{type:[String,Number],required:!0},scrollable:{type:Boolean,required:!0},transition:{type:String,required:!0},width:{type:[String,Number],required:!0}},setup(e){const n=t.ref(),o=()=>{var a,l;(l=(a=n.value)==null?void 0:a.animate)==null||l.call(a,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:"cubic-bezier(0.4, 0, 0.2, 1)"})},r=t.computed(()=>["g-dialog-frame",{"g-dialog-frame--active":e.isActive,"g-dialog-frame--local":e.local}]),i=t.computed(()=>({zIndex:e.zIndex}));return{frameElement:n,classes:r,styles:i,animateClick:o}}});function ee(e,n,o,r,i,a){const l=t.resolveComponent("GDialogContent");return t.openBlock(),t.createBlock(t.Transition,{name:e.transition},{default:t.withCtx(()=>[t.withDirectives(t.createElementVNode("div",{ref:"frameElement",class:t.normalizeClass(e.classes),style:t.normalizeStyle(e.styles)},[t.createVNode(l,{class:t.normalizeClass(e.contentClass),"max-width":e.maxWidth,width:e.width,height:e.height,scrollable:e.scrollable,depressed:e.depressed,fullscreen:e.fullscreen,background:e.background,"border-radius":e.borderRadius},{default:t.withCtx(()=>[t.renderSlot(e.$slots,"default")]),_:3},8,["class","max-width","width","height","scrollable","depressed","fullscreen","background","border-radius"])],6),[[t.vShow,e.isActive]])]),_:3},8,["name"])}var te=h(x,[["render",ee]]);const ne=t.defineComponent({name:"GDialog",components:{GDialogOverlay:Y,GDialogFrame:te},inheritAttrs:!1,props:{background:{type:[Boolean,String],default:!0},borderRadius:{type:[Boolean,Number,String],default:!0},contentClass:{type:String,default:""},depressed:Boolean,fullscreen:Boolean,height:{type:[String,Number],default:"auto"},local:Boolean,maxWidth:{type:[String,Number],default:"none"},modelValue:Boolean,noClickAnimation:Boolean,overlayBackground:{type:[Boolean,String],default:!0},persistent:Boolean,scrollable:Boolean,teleportTo:{type:String,default:"body"},disableTeleport:Boolean,transition:{type:String,default:"g-dialog-transition"},width:{type:[String,Number],default:"auto"},closeOnBack:{type:Boolean,default:!1}},emits:{"update:modelValue":e=>!0},setup(e,{emit:n}){const o=t.ref(null),r=t.ref(null),i=t.computed(()=>{var s;return(s=o.value)==null?void 0:s.$el}),a=t.computed(()=>{var s;return(s=r.value)==null?void 0:s.$el}),l=t.ref(!1),{isTop:c}=L(l);B&&e.modelValue&&t.nextTick(()=>{l.value=!0}),t.watch(()=>e.modelValue,s=>{l.value=s});const d=()=>{l.value=!1,n("update:modelValue",!1)},m=()=>{l.value=!0,n("update:modelValue",!0)},{activatedOnce:I,active:w}=j(l),{zIndex:f}=P(w),C=()=>{var s;e.noClickAnimation||(s=r.value)==null||s.animateClick()};U("keyup",s=>{s.key==="Escape"&&c.value&&(e.persistent?C():d())},{passive:!0});const{enableScroll:q,disableScroll:de}=M({overlay:i,content:a,contentActiveClass:"g-dialog-frame--active",fullscreen:e.fullscreen,contentFullscreenClass:"g-dialog-frame--fullscreen"});t.watch(w,s=>{e.local||(s?de():q())}),t.onBeforeUnmount(()=>{q()});const ce=()=>{e.persistent?C():d()};if(B&&e.closeOnBack){const s=t.getCurrentInstance();let g=`dialog-${s.uid}`;window.location.hash&&(g=`${window.location.hash.slice(1)}-${g}`);const O=()=>{window.location.hash.includes(g)||!l.value||d()};t.onMounted(()=>{l.value&&(window.location.hash=g),window.addEventListener("popstate",O)}),t.onUnmounted(()=>{window.removeEventListener("popstate",O)}),t.watch(l,V=>{!V&&window.location.hash.includes(g)?window.history.back():V&&(window.location.hash?g=`${window.location.hash.slice(1)}-${`dialog-${s.uid}`}`:g=`dialog-${s.uid}`,window.location.hash=`#${g}`)})}return{overlayComponent:o,frameComponent:r,activatedOnce:I,zIndex:f,isActive:w,activatorAttrs:{onClick(){m()}},onClickOutside:ce,onClose:d}}});function oe(e,n,o,r,i,a){const l=t.resolveComponent("GDialogOverlay"),c=t.resolveComponent("GDialogFrame");return t.openBlock(),t.createElementBlock(t.Fragment,null,[t.renderSlot(e.$slots,"activator",t.normalizeProps(t.guardReactiveProps(e.activatorAttrs))),e.activatedOnce?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[(t.openBlock(),t.createBlock(t.Teleport,{to:e.teleportTo,disabled:e.local||e.disableTeleport},[e.fullscreen?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock(l,{key:0,ref:"overlayComponent",active:e.isActive,"z-index":e.zIndex,background:e.overlayBackground,local:e.local,onClick:e.onClickOutside},null,8,["active","z-index","background","local","onClick"]))],8,["to","disabled"])),(t.openBlock(),t.createBlock(t.Teleport,{to:e.teleportTo,disabled:e.local||e.disableTeleport},[t.createVNode(c,{ref:"frameComponent","is-active":e.isActive,"z-index":e.zIndex,"max-width":e.maxWidth,width:e.width,height:e.height,scrollable:e.scrollable,transition:e.transition,depressed:e.depressed,fullscreen:e.fullscreen,background:e.background,"border-radius":e.borderRadius,"content-class":e.contentClass,local:e.local,persistent:e.persistent},{default:t.withCtx(()=>[t.renderSlot(e.$slots,"default",{onClose:e.onClose})]),_:3},8,["is-active","z-index","max-width","width","height","scrollable","transition","depressed","fullscreen","background","border-radius","content-class","local","persistent"])],8,["to","disabled"]))],64)):t.createCommentVNode("",!0)],64)}var re=h(ne,[["render",oe]]);const y=t.shallowReactive([]),v={pluginIsNotInitialized(){console.error("The gitart-vue-dialog plugin is not initialized. Read how to solve: https://gitart-vue-dialog.gitart.org/guide/usage/plugin-usage.html#installation")}},_=Symbol("GDialog"),T={dialogs:[],addDialog:()=>{v.pluginIsNotInitialized()},removeDialog:()=>{v.pluginIsNotInitialized()}},le={install:(e,n)=>{var a,l;const o=(a=n==null?void 0:n.closeDelay)!=null?a:500,r=(l=n==null?void 0:n.props)!=null?l:{},i={dialogs:y,addDialog:({component:c,props:d})=>{y.push({component:c,id:Date.now()+Math.random(),props:t.reactive({modelValue:!0,...r,...d})})},removeDialog:(c,d)=>{const m=y[c];!m.props.modelValue||(m.props.modelValue=!1,setTimeout(()=>{y.splice(y.indexOf(m),1)},d!=null?d:o))}};e.provide(_,i),e.config.globalProperties.$dialog=i}},ae=t.defineComponent({name:"GDialogRoot",setup(){const{dialogs:e,removeDialog:n}=t.inject(_,T);e===T.dialogs&&v.pluginIsNotInitialized();function o(r){n(r)}return{dialogs:e,onClose:o}}});function ie(e,n,o,r,i,a){return t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.dialogs,(l,c)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(l.component),t.mergeProps({key:l.id},l.props,{"onUpdate:modelValue":d=>e.onClose(c)}),null,16,["onUpdate:modelValue"]))),128)}var se=h(ae,[["render",ie]]);u.GDialog=re,u.GDialogRoot=se,u.dialogInjectionKey=_,u.plugin=le,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
